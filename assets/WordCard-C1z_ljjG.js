var W=Object.defineProperty;var _=(o,e,s)=>e in o?W(o,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[e]=s;var d=(o,e,s)=>_(o,typeof e!="symbol"?e+"":e,s);import{m as V,u as N}from"./function-call-CPLKCKjj.js";import{q as B,s as T,v as M,e as m,x as O,y as I,d as U,c as A,a as h,n as $,b as u,k as g,t as c,f as w,r as v,z as f,w as y,h as p,p as z}from"./index-CeFBid1j.js";import{u as q}from"./ProgressBar-TXeMBF19.js";import{_ as D}from"./_plugin-vue_export-helper-DlAUqK2U.js";let b,a;const J=o=>M(o)?o:{message:o};function L(){({instance:a}=V({setup(){const{state:o,toggle:e}=N();return()=>m(I,O(o,{"onUpdate:show":e}),null)}}))}const P=()=>({type:"danger",color:void 0,message:"",onClose:void 0,onClick:void 0,onOpened:void 0,duration:3e3,position:void 0,className:"",lockScroll:!1,background:void 0});let j=P();const F=()=>{a&&a.toggle(!1)};function re(o){if(B)return a||L(),o=T({},j,J(o)),a.open(o),clearTimeout(b),o.duration>0&&(b=setTimeout(F,o.duration)),a}class G{constructor(){d(this,"sounds",new Map);d(this,"enabled",!0);d(this,"bgmEnabled",!0);d(this,"speechSynthesis",null);this.init(),typeof window<"u"&&window.speechSynthesis&&window.speechSynthesis.getVoices()}init(){const e=localStorage.getItem("gameSettings");if(e){const{soundEnabled:s,musicEnabled:n}=JSON.parse(e);this.enabled=s!==void 0?s:!0,this.bgmEnabled=n!==void 0?n:!0}typeof window<"u"&&window.speechSynthesis&&(this.speechSynthesis=window.speechSynthesis,this.speechSynthesis.onvoiceschanged!==void 0&&(this.speechSynthesis.onvoiceschanged=()=>{console.log("语音列表已加载")})),this.preloadSounds()}preloadSounds(){this.loadSound("correct","/sounds/correct.mp3"),this.loadSound("wrong","/sounds/wrong.mp3"),this.loadSound("levelComplete","/sounds/level-complete.mp3"),this.loadSound("click","/sounds/click.mp3"),this.loadSound("bgm","/sounds/bgm.mp3")}loadSound(e,s){const n=new Audio(s);this.sounds.set(e,n)}play(e){if(!this.enabled&&e!=="bgm"||!this.bgmEnabled&&e==="bgm")return;const s=this.sounds.get(e);s&&(e!=="bgm"&&(s.currentTime=0),s.play().catch(n=>{console.warn("音效播放失败:",n)}))}speakWord(e){if(!this.enabled||!this.speechSynthesis)return;this.speechSynthesis.cancel(),console.log("准备播放单词:",e);const s=new SpeechSynthesisUtterance(e);s.lang="en-US",s.rate=.8;try{if(this.speechSynthesis.getVoices().length===0){console.log("语音列表为空，尝试延迟加载..."),setTimeout(()=>{this.speakWordWithVoices(e)},100);return}this.speakWordWithVoices(e)}catch(n){console.error("语音播放失败:",n)}}speakWordWithVoices(e){if(!this.speechSynthesis)return;const s=new SpeechSynthesisUtterance(e);s.lang="en-US",s.rate=.8;const i=this.speechSynthesis.getVoices().filter(r=>r.lang.includes("en-US"));console.log("可用的英语语音列表:",i),i.length>0&&(s.voice=i[0],console.log("已选择语音:",s.voice.name)),s.onerror=r=>{console.error("语音合成错误:",r)},s.onend=()=>{console.log("单词播放完成")},this.speechSynthesis.speak(s)}stop(e){const s=this.sounds.get(e);s&&(s.pause(),s.currentTime=0)}stopAll(){this.sounds.forEach(e=>{e.pause(),e.currentTime=0})}setEnabled(e){this.enabled=e,this.saveSettings(),e||this.sounds.forEach((s,n)=>{n!=="bgm"&&(s.pause(),s.currentTime=0)})}setBgmEnabled(e){if(this.bgmEnabled=e,this.saveSettings(),e){const s=this.sounds.get("bgm");s&&(s.loop=!0,s.play().catch(n=>console.error("播放背景音乐失败:",n)))}else this.stop("bgm")}saveSettings(){const e={soundEnabled:this.enabled,musicEnabled:this.bgmEnabled};localStorage.setItem("gameSettings",JSON.stringify(e))}}const k=new G,H=o=>k.play(o),K=o=>k.speakWord(o),Q={class:"word-card-content"},R={class:"word-english"},X={class:"word-phonetic"},Y={key:0,class:"word-chinese"},Z={key:1,class:"word-image"},x=["src","alt"],ee={key:2,class:"word-actions"},se=U({__name:"WordCard",props:{word:{},showChinese:{type:Boolean,default:!1},showActions:{type:Boolean,default:!1},showImage:{type:Boolean,default:!1}},emits:["learn","master","click"],setup(o){const e=o,s=q(),n=A(()=>s.learnedWords.includes(e.word.id)),i=()=>{K(e.word.english),H("click");const t=document.querySelector(".word-english");t&&z(t,"pulse",500)},r=()=>{i()};return(t,l)=>{const C=v("van-icon"),S=v("van-button");return p(),h("div",{class:$(["word-card",{mastered:t.word.isMastered}]),onClick:r},[u("div",Q,[u("div",R,c(t.word.english),1),u("div",X,[w(c(t.word.phonetic)+" ",1),m(C,{name:"volume-o",class:"sound-icon",onClick:f(i,["stop"])})]),t.showChinese?(p(),h("div",Y,c(t.word.chinese),1)):g("",!0),t.showImage?(p(),h("div",Z,[u("img",{src:`/images/words/${t.word.english.toLowerCase()}.svg`,alt:t.word.english,class:"word-illustration"},null,8,x)])):g("",!0),t.showActions?(p(),h("div",ee,[m(S,{size:"small",type:n.value?"warning":"primary",onClick:l[0]||(l[0]=f(E=>t.$emit("learn",t.word.id),["stop"]))},{default:y(()=>[w(c(n.value?"取消学习":"学习"),1)]),_:1},8,["type"]),m(S,{size:"small",type:t.word.isMastered?"warning":"success",onClick:l[1]||(l[1]=f(E=>t.$emit("master",t.word.id),["stop"]))},{default:y(()=>[w(c(t.word.isMastered?"取消掌握":"掌握"),1)]),_:1},8,["type"])])):g("",!0)])],2)}}}),de=D(se,[["__scopeId","data-v-b2a6af4b"]]);export{de as W,K as a,H as p,re as s};
